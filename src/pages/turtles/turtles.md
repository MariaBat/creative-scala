## Ελέγχοντας το Turtle

```tut:invisible
import doodle.core._
import doodle.core.Image._
import doodle.syntax._
import doodle.jvm.Java2DFrame._
import doodle.backend.StandardInterpreter._
```

Θα δούμε το API για τα γραφικά turtle και θα το χρησιμοποιήσουμε για να φτιάξουμε μερικές εικόνες.


### Εντολές

Ελέγχουμε το turtle δίνοντάς του εντολές.
Αυτές οι εντολές, ορίζονται ως μέθοδοι του αντικειμένου `doodle.turtle.Instruction` (παρόμοια με τις μεθόδους του αντικειμένου `doodle.core.Image`).

Αφού εισάγουμε τις μεθόδους αυτές με την χρήση του import θα είμαστε έτοιμοι να δημιουργήσουμε εντολές.

```tut:silent:book
import doodle.turtle._
import doodle.turtle.Instruction._
```
```tut:book
forward(10)
turn(5.degrees)
```

Ο παραπάνω κώδικας δεν μπορεί να κάνει τίποτα χρήσιμο αν δεν ομαδοποιήσουμε αυτές τις εντολές ώστε να δημιουργήσουμε μια εικόνα.
Για να το κάνουμε αυτό, φτιάχνουμε μία λίστα εντολών και ζητάμε από το turtle (για την ακρίβεια από το `doodle.turtle.Turtle`) να τις σχεδιάσει σε μια `Image`.

```tut:silent:book
val instructions = 
  List(forward(10), turn(90.degrees), 
       forward(10), turn(90.degrees), 
       forward(10), turn(90.degrees), 
       forward(10))

val path = Turtle.draw(instructions)
```

Δημιουργείται έτσι ένα μονοπάτι---μία `Image`---την οποία μπορούμε μετά να ζωγραφίσουμε ως συνήθως.
Το αποτέλεσμα του παραπάνω κώδικα είναι η εικόνα [@fig:turtles:square].
Δεν είναι κάτι ιδιαίτερο αλλά μπορούμε να αλλάξουμε το χρώμα, το πάχος της γραμμής καθώς και πολλά άλλα στοιχεία της ώστε να δημιουργήσουμε κάτι πιο ενδιαφέρον.

![Ένα τετράγωνο που δημιουργήθηκε με την βοήθεια του συστήματος γραφικών turtle.](src/pages/turtles/square.pdf+svg){#fig:turtles:square}

Στον πίνακα [@tbl:turtles:instructions] μπορείτε να δείτε την πλήρη λίστα εντολών για το turtle

------------------------------------------------------------------------------------------------
Εντολή                     Περιγραφή                            Παράδειγμα
-------------------------- ------------------------------------ --------------------------------
`forward(distance)`        Προχώρα όσο είναι η `distance`       `forward(100.0)`
                           (απόσταση), τύπου `Double`.

`turn(angle)`              Στρίψε όσο είναι η `angle`           `turn(10.degrees)`
                           (γωνία) από την
                           τωρινή σου κατεύθυνση.

`branch(instruction, ...)` Αποθήκευσε την θέση και την          `branch(turn(10.degrees), forward(10))`
                           κατεύθυνσή σου, ζωγράφισε σύμφωνα
                           με τις `instructions` (εντολές) και
                           μετά επέστρεψε στην αρχική σου θέση
                           ώστε να ζωγραφίσεις τις υπόλοιπες
                           εντολές.
                                  
`noop`                     Μην κάνεις τίποτα!                   `noop`
------------------------------------------------------------------------------------------------

: οι εντολές που καταλαβαίνει το turtle. {#tbl:turtles:instructions}

### Ασκήσεις {-}

#### Πολύγωνα {-}

Στο προηγούμενο κεφάλαιο γράψαμε μία μέθοδο για την δημιουργία ενός πολυγώνου. Φτιάξτε και πάλι αυτή την μέθοδο. Αυτή τη φορά χρησιμοποιήστε γραφικά turtle. Η δήλωση της μεθόδου θα πρέπει να μοιάζει με την παρακάτω

```tut:silent:book
def polygon(sides: Int, sideLength: Double): Image =
 ???
```

Για να βρείτε την σωστή γωνία περιστροφής θα πρέπει να χρησιμοποιήσετε λίγη γεωμετρία. Αυτή είναι η μισή διασκέδαση, οπότε δεν θα σας το χαλάσουμε δίνοντάς σας την απάντηση.

<div class="solution">
Παρακάτω μπορείτε να δείτε την δική μας λύση. Είναι μία δομημένη αναδρομή με φυσικούς αριθμούς. Η γωνία είναι ίδια με την γωνία περιστροφής που χρησιμοποιήσαμε για την κατασκευή πολυγώνων με πολικές συντεταγμένες, σε προηγούμενο κεφάλαιο. Όμώς εδώ, η διαδικασία σχεδιασμού είναι εντελώς διαφορετική.

```tut:silent:book
def polygon(sides: Int, sideLength: Double): Image = {
  val rotation = Angle.one / sides
  def iter(n: Int): List[Instruction] =
    n match {
      case 0 => Nil
      case n => turn(rotation) :: forward(sideLength) :: iter(n-1)
    }

  Turtle.draw(iter(sides))
}
```
</div>


#### Το Τετράγωνο Σπειροειδές

Στην εικόνα [@fig:turtles:square-spiral] μπορείτε να δείτε ένα τετράγωνο σπειροειδές σχήμα. Γράψτε μία μέθοδο που δημιουργεί τετράγωνα σπειροειδή, χρησιμοποιώντας γραφικά turtle.

Αυτή η άσκηση απαιτεί περισσότερη δουλειά από όσο σας ζητάμε συνήθως. Θα πρέπει να βρείτε πώς κατασκευάζεται το τετράγωνο σπειροειδές (βοήθεια: ξεκινάει από το κέντρο) και μετά να κατασκευάσετε την μέθοδο που το σχεδιάζει.

![Το τετράγωνο σπειροειδές!](src/pages/turtles/square-spiral.pdf+svg){#fig:turtles:square-spiral}

<div class="solution">
Παρακάτω μπορείτε να δείτε τα βασικά στοιχεία για τον σχεδιασμό του τετράγωνου σπειροειδούς:

- κάθε στροφή είναι λίγο μικρότερη από 90 μοίρες
- κάθε βήμα μπροστά είναι λίγο μεγαλύτερο από το προηγούμενο

Μόλις κατανοήσετε τα παραπάνω, θα δείτε ότι η δομή του κώδικα είναι σχεδόν ίδια με αυτή του σχεδιασμού ενός πολυγώνου. Δείτε την λύση μας.

```tut:book
def squareSpiral(steps: Int, distance: Double, angle: Angle, increment: Double): Image = {
  def iter(n: Int, distance: Double): List[Instruction] = {
    n match {
      case 0 => Nil
      case n => forward(distance) :: turn(angle) :: iter(steps-1, distance + increment)
    }
  }

  Turtle.draw(iter(steps, distance))
}
```
</div>

#### Γραφικά Turtle vs Πολικές Συντεταγμένες {-}

Μπορούμε να δημιουργήσουμε πολύγωνα με πολικές συντεταγμένες χρησιμοποιώντας ένα `Range` και ένα `map` όπως φαίνεται παρακάτω.

```tut:silent:book
import doodle.core.Point._

def polygon(sides: Int, size: Int): Image = {
  val rotation = Angle.one / sides
  val elts =
    (1 to sides).toList.map { i =>
      PathElement.lineTo(polar(size, rotation * i))
    }
  closedPath(PathElement.moveTo(polar(size, Angle.zero)) :: elts)
}
```

Όμως δεν είναι το ίδιο εύκολο να γράψουμε την ίδια μέθοδο για παραγωγή εντολών turtle χρησιμοποιώντας ένα `Range` και ένα `map`. Γιατί; Τι μας λείπει;

<div class="solution">
Κάθε πλευρά του πολυγώνου απαιτεί δύο εντολές turtle: μία `forward` και μία `turn`. Άρα, για να ζωγραφίσουμε ένα πεντάγωνο θα χρειαστούν δέκα εντολές. Γενικότερα `n` πλευρές θα χρειαστούν `2n` εντολές.
Χρησιμοποιώντας την `map` δεν μπορούμε να αλλάξουμε τον αριθμό των στοιχείων μίας λίστας. Δηλαδή, το να έχουμε μία map από `1` ως `n`, όπως κάναμε παραπάνω, δεν θα λειτουργήσει σ' αυτή την περίπτωση. Θα μπορούσαμε να έχουμε ένα map για `1 ως (n*2)` και στους περιττούς αριθμούς να κινείται μπροστά ενώ στους άρτιους να στρίβει αλλά αυτός ο τρόπος δεν είναι πολύ κομψός. Θα ήταν πολύ βολικό να είχαμε μία δομή σαν την map, που μας επιτρέπει την αλλαγή του πλήθους των στοιχείων μίας λίστας.
</div>
